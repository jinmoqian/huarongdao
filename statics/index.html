<html>
    <head>
        <meta charset="UTF-8">
        <script lang="JavaScript" src="statics/libcanvas.js" ></script>
        <script lang="JavaScript" src="statics/game.js" ></script>
        <title>Huarong Dao</title>
    </head>
    <body>
        <div style='margin:0 auto; width: 724px; background-color: rgb(0,255,0); color: rgb(255,255,0);'>
            <canvas id="game" width="724" height="500"></canvas>
        </div>
    </body>
    <script lang="JavaScript">main("game");</script>
    <script lang="JavaScript">
        var now=new Date();
        if({keepAlive}){
            setTimeout(function(){
                setInterval(function(){
                    request("keepalive", "", function(succ, content){
                        if( succ ){
                            now=new Date();
                        }
                    })
                }, 1000)
            }, 1000)
            setInterval(function(){
                var diff=(new Date()).getTime()-now.getTime();
                if (diff > 3000){
                    window.opener=null; window.open('','_self'); window.close();
                    console.log("closing")
                }
                console.log(diff);
            }, 1000);
        }
    </script>
</html>
